---
{"dg-publish":true,"permalink":"/9.일지/2025/2025-09-03/","dgPassFrontmatter":true,"noteIcon":""}
---

## To-Do List
- [ ] RAC DRM 사례 재현 테스트 설계: 워크로드 전환(파티션/핫블록) 시점에 DRM 트리거 유도, 수집 지표 확정
  - [ ] 수집: alert.log, GV$GES_RESOURCE master_instance, GV$SESSION_WAIT, gc 관련 대기, LMS/LMD 트레이스
  - [ ] 비교: DRM 전/후 블록 마스터 이동량, gc cr/current 지연, interconnect 대역폭
- [ ] AIX 우선순위 튜닝 플레이북 작성: nice/renice 기준, 실시간(SCHED_FIFO/RR) 사용 경계, CPU 바인딩 지침
  - [ ] 확인: ps -eLo pid,pri,nice,pcpu,comm, bindprocessor -q/-p, schedo -o timeslice 값
  - [ ] 적용: renice 범위(−20~19), 실시간 클래스 전환은 최소화(운영 정책 문서화)
- [ ] Control file 업데이트 확인 절차 정식화
  - [ ] SQL 점검: SELECT controlfile_change#, controlfile_time FROM v$database;
  - [ ] 섹션 점검: SELECT type,records_used,records_total FROM v$controlfile_record_section ORDER BY type;
  - [ ] 강제 이벤트로 확인: ALTER SYSTEM CHECKPOINT; 또는 ARCHIVE LOG CURRENT; 실행 전후 값 비교

## 기술 파트
### 1) RAC DRM 오류/현상 해설
- 개념: DRM(Dynamic Resource Mastering)은 리소스(블록/오브젝트)의 마스터 노드를 동적으로 재배치해 cross-instance 트래픽을 줄이는 RAC 기능.
- 전형 증상
  - 워크로드 편중 시점에 gc 관련 대기 증가 후 완화(마스터 재배치 중 일시 지연 가능).
  - alert.log에 reconfiguration/DRM 관련 메시지, LMS/LMD 트레이스 증가(구체 메시지는 환경 의존 — 확실하지 않음).
- 진단 절차(일반 원칙)
  - 마스터 현황: GV$GES_RESOURCE에서 MASTER_INSTANCE 샘플링, 핫 세그먼트의 마스터 이동 추적.
  - 대기/지표: GV$SESSION_WAIT, AWR의 “gc cr/current” 계열, 인터커넥트 통계 비교.
  - 타이밍 상관: reconfiguration 시각과 대기 급증 구간 매칭.
- 대응 가이드(추측입니다)
  - 핫 오브젝트의 인스턴스 지역성 강화(파티셔닝/서비스 라우팅 조정).
  - 재배치 빈도 완화(짧은 시간에 테이블스캔·파티션 이동 반복 지양), 인터커넥트/CPU 포화 해소.

### 2) AIX 프로세스 우선순위
- 기본: 타임쉐어 클래스에서 nice(−20~19)로 상대 우선순위 조정, 값이 낮을수록 우선.
- 실시간 클래스: SCHED_FIFO/RR는 선점 강도 높음(오남용 시 시스템 응답성 저하 위험 — 확실하지 않음). 운영 환경에서는 제한적으로만 사용.
- 확인/적용 예
  - 조회: ps -eLo pid,pri,nice,pcpu,comm
  - 우선순위 변경: renice -n -5 -p <PID>
  - CPU 바인딩: bindprocessor <PID> <CPU_ID>
  - 스케줄러 튜닝 확인: schedo -o timeslice
- 권장
  - 병목 프로세스에 소폭 음수 nice 적용 후 효과 관찰, 실시간 전환은 증거 기반으로 최소화.
  - 코어 바인딩은 캐시 지역성 개선에만 사용, IO 대기형 작업엔 과효과 제한적.

### 3) Control file 업데이트 확인
- 목적: 컨트롤파일이 최근 이벤트(체크포인트/아카이브/로그 스위치 등)를 반영하는지 점검.
- 핵심 쿼리
  - SELECT controlfile_change#, controlfile_time FROM v$database;
  - SELECT type,records_used,records_total FROM v$controlfile_record_section ORDER BY type;
- 검증 플로우(일반 원칙)
  1. 현재 값 기록
  2. ALTER SYSTEM CHECKPOINT; 또는 ALTER SYSTEM ARCHIVE LOG CURRENT; 실행
  3. 값 재조회해 증가/시간 갱신 확인
- 파일시스템/ASM 참고
  - 파일시스템 배치 시 OS mtime 확인 가능, ASM은 asmcmd ls -l 경로에서 타임스탬프 확인(환경별 차이 — 확실하지 않음).

## 비기술 파트
- 용어 정리와 재현 가능 절차 강조, 운영 안전선(실시간 스케줄링/DRM 빈도) 정의 필요성 합의.

## 감정 상태
- 원인 규명과 재현 설계에 몰입. 로그·지표 기반 검증 지향 유지.

## 해시태그
#OracleRAC #DRM #AIX #Priority #Controlfile