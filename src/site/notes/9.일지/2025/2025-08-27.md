---
{"dg-publish":true,"permalink":"/9.일지/2025/2025-08-27/","dgPassFrontmatter":true,"noteIcon":""}
---


## To-Do List
- [ ] AWR/ASH 교차점검: Primary·Standby 모두에서 ‘DX-Distributed Transaction’ 비중, 발생 시각, 세션/SQL 상관 분석
- [ ] 분산 트랜잭션 진단: DBA_2PC_PENDING/DBA_2PC_NEIGHBORS, DB 링크 사용 흔적, in-doubt 트랜잭션 유무 점검
- [ ] Standby 지표 타당성 확인: ADG(Standby)에서의 DX 집계 특성 검증(적용/재생 스레드 포함 여부) 및 대체 지표 선정
- [ ] 체크포인트 큐 래치 분석: v$latch_children(‘checkpoint queue latch’), ASH로 latch: 관련 이벤트 상위 세션 추적
- [ ] AWR_DIFF 재분석: Wait Class/Top SQL/IO by Filetype/Background vs Foreground 분리 비교 리포트 재생성

## 기술 파트
- AWR의 DX(Distributed Transaction) 해설 및 대응
  - 의미: 2PC(2-Phase Commit)·DB Link 연계 시 사용되는 분산 트랜잭션 관련 대기/엔큐로 해석하는 것이 일반적(환경에 따라 상이 가능 — 확실하지 않음)
  - 1차 점검: DBA_2PC_PENDING, DBA_2PC_NEIGHBORS, GV$GLOBAL_TRANSACTION로 in-doubt 유무·지연 지점 확인
  - 2차 점검: DB Link 사용 흔적, 트랜잭션 타임아웃/재시도 설정, 네트워크 지연과의 상관
  - 조치 예: in-doubt 강제 해소, DB Link 타임아웃·재시도 파라미터 조정, 네트워크 병목 제거(구체값은 환경 의존 — 확실하지 않음)
- Active Data Guard(Standby)에서 DX 수치가 올라가는 이유(가설)
  - 리두 적용 과정에서 분산 트랜잭션 관련 엔큐가 집계될 수 있음(버전·패치·통계 집계 방식에 의존 — 추측입니다)
  - 대체 관측: Managed Recovery/Apply 세션의 이벤트 분포, MRP/RFS 관련 백그라운드 대기 비교로 진단
- 체크포인트 큐 래치(kcbrmflx/kcbr_apply: change influxq) 메모
  - 증상: checkpoint queue latch 관련 래치 경합 포착
  - 확인: v$latch_children에서 ‘checkpoint queue latch’ 검색, ASH로 latch: 관련 이벤트의 p1(주소)로 child 매핑
  - 맥락: DBWR 쓰기·체크포인트 빈도·redo 폭주·hot datafile 가능성 등과 상관(환경 의존 — 확실하지 않음)
- AWR_DIFF 재분석 권장 흐름
  - ① DB Time/CPU Time 추세 ② Wait Class 상위 항목 ③ Top SQL by DB Time/Elapsed ④ Filetype별 IO Lat/Throughput ⑤ Foreground vs Background 분리 ⑥ Latch/Enqueue 상위 Top-N ⑦ 개선 가설→실험→재측정

## 감정 상태
- 진단 항목을 빠르게 구조화해 실험 계획으로 잇는 흐름 유지. 세부 지표의 해석 타당성 검증 의지 돋보임.

## 해시태그
#AWR #ADG #DX #Latch #AWRDIFF #macOS #모주